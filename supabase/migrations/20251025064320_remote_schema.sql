revoke delete on table "public"."blacklisted_users" from "anon";

revoke insert on table "public"."blacklisted_users" from "anon";

revoke references on table "public"."blacklisted_users" from "anon";

revoke select on table "public"."blacklisted_users" from "anon";

revoke trigger on table "public"."blacklisted_users" from "anon";

revoke truncate on table "public"."blacklisted_users" from "anon";

revoke update on table "public"."blacklisted_users" from "anon";

revoke delete on table "public"."blacklisted_users" from "authenticated";

revoke insert on table "public"."blacklisted_users" from "authenticated";

revoke references on table "public"."blacklisted_users" from "authenticated";

revoke select on table "public"."blacklisted_users" from "authenticated";

revoke trigger on table "public"."blacklisted_users" from "authenticated";

revoke truncate on table "public"."blacklisted_users" from "authenticated";

revoke update on table "public"."blacklisted_users" from "authenticated";

revoke delete on table "public"."blacklisted_users" from "service_role";

revoke insert on table "public"."blacklisted_users" from "service_role";

revoke references on table "public"."blacklisted_users" from "service_role";

revoke select on table "public"."blacklisted_users" from "service_role";

revoke trigger on table "public"."blacklisted_users" from "service_role";

revoke truncate on table "public"."blacklisted_users" from "service_role";

revoke update on table "public"."blacklisted_users" from "service_role";

revoke delete on table "public"."blog_posts" from "anon";

revoke insert on table "public"."blog_posts" from "anon";

revoke references on table "public"."blog_posts" from "anon";

revoke select on table "public"."blog_posts" from "anon";

revoke trigger on table "public"."blog_posts" from "anon";

revoke truncate on table "public"."blog_posts" from "anon";

revoke update on table "public"."blog_posts" from "anon";

revoke delete on table "public"."blog_posts" from "authenticated";

revoke insert on table "public"."blog_posts" from "authenticated";

revoke references on table "public"."blog_posts" from "authenticated";

revoke select on table "public"."blog_posts" from "authenticated";

revoke trigger on table "public"."blog_posts" from "authenticated";

revoke truncate on table "public"."blog_posts" from "authenticated";

revoke update on table "public"."blog_posts" from "authenticated";

revoke delete on table "public"."blog_posts" from "service_role";

revoke insert on table "public"."blog_posts" from "service_role";

revoke references on table "public"."blog_posts" from "service_role";

revoke select on table "public"."blog_posts" from "service_role";

revoke trigger on table "public"."blog_posts" from "service_role";

revoke truncate on table "public"."blog_posts" from "service_role";

revoke update on table "public"."blog_posts" from "service_role";

revoke delete on table "public"."character_factions" from "anon";

revoke insert on table "public"."character_factions" from "anon";

revoke references on table "public"."character_factions" from "anon";

revoke select on table "public"."character_factions" from "anon";

revoke trigger on table "public"."character_factions" from "anon";

revoke truncate on table "public"."character_factions" from "anon";

revoke update on table "public"."character_factions" from "anon";

revoke delete on table "public"."character_factions" from "authenticated";

revoke insert on table "public"."character_factions" from "authenticated";

revoke references on table "public"."character_factions" from "authenticated";

revoke select on table "public"."character_factions" from "authenticated";

revoke trigger on table "public"."character_factions" from "authenticated";

revoke truncate on table "public"."character_factions" from "authenticated";

revoke update on table "public"."character_factions" from "authenticated";

revoke delete on table "public"."character_factions" from "service_role";

revoke insert on table "public"."character_factions" from "service_role";

revoke references on table "public"."character_factions" from "service_role";

revoke select on table "public"."character_factions" from "service_role";

revoke trigger on table "public"."character_factions" from "service_role";

revoke truncate on table "public"."character_factions" from "service_role";

revoke update on table "public"."character_factions" from "service_role";

revoke delete on table "public"."character_gallery" from "anon";

revoke insert on table "public"."character_gallery" from "anon";

revoke references on table "public"."character_gallery" from "anon";

revoke select on table "public"."character_gallery" from "anon";

revoke trigger on table "public"."character_gallery" from "anon";

revoke truncate on table "public"."character_gallery" from "anon";

revoke update on table "public"."character_gallery" from "anon";

revoke delete on table "public"."character_gallery" from "authenticated";

revoke insert on table "public"."character_gallery" from "authenticated";

revoke references on table "public"."character_gallery" from "authenticated";

revoke select on table "public"."character_gallery" from "authenticated";

revoke trigger on table "public"."character_gallery" from "authenticated";

revoke truncate on table "public"."character_gallery" from "authenticated";

revoke update on table "public"."character_gallery" from "authenticated";

revoke delete on table "public"."character_gallery" from "service_role";

revoke insert on table "public"."character_gallery" from "service_role";

revoke references on table "public"."character_gallery" from "service_role";

revoke select on table "public"."character_gallery" from "service_role";

revoke trigger on table "public"."character_gallery" from "service_role";

revoke truncate on table "public"."character_gallery" from "service_role";

revoke update on table "public"."character_gallery" from "service_role";

revoke delete on table "public"."character_locations" from "anon";

revoke insert on table "public"."character_locations" from "anon";

revoke references on table "public"."character_locations" from "anon";

revoke select on table "public"."character_locations" from "anon";

revoke trigger on table "public"."character_locations" from "anon";

revoke truncate on table "public"."character_locations" from "anon";

revoke update on table "public"."character_locations" from "anon";

revoke delete on table "public"."character_locations" from "authenticated";

revoke insert on table "public"."character_locations" from "authenticated";

revoke references on table "public"."character_locations" from "authenticated";

revoke select on table "public"."character_locations" from "authenticated";

revoke trigger on table "public"."character_locations" from "authenticated";

revoke truncate on table "public"."character_locations" from "authenticated";

revoke update on table "public"."character_locations" from "authenticated";

revoke delete on table "public"."character_locations" from "service_role";

revoke insert on table "public"."character_locations" from "service_role";

revoke references on table "public"."character_locations" from "service_role";

revoke select on table "public"."character_locations" from "service_role";

revoke trigger on table "public"."character_locations" from "service_role";

revoke truncate on table "public"."character_locations" from "service_role";

revoke update on table "public"."character_locations" from "service_role";

revoke delete on table "public"."character_outfits" from "anon";

revoke insert on table "public"."character_outfits" from "anon";

revoke references on table "public"."character_outfits" from "anon";

revoke select on table "public"."character_outfits" from "anon";

revoke trigger on table "public"."character_outfits" from "anon";

revoke truncate on table "public"."character_outfits" from "anon";

revoke update on table "public"."character_outfits" from "anon";

revoke delete on table "public"."character_outfits" from "authenticated";

revoke insert on table "public"."character_outfits" from "authenticated";

revoke references on table "public"."character_outfits" from "authenticated";

revoke select on table "public"."character_outfits" from "authenticated";

revoke trigger on table "public"."character_outfits" from "authenticated";

revoke truncate on table "public"."character_outfits" from "authenticated";

revoke update on table "public"."character_outfits" from "authenticated";

revoke delete on table "public"."character_outfits" from "service_role";

revoke insert on table "public"."character_outfits" from "service_role";

revoke references on table "public"."character_outfits" from "service_role";

revoke select on table "public"."character_outfits" from "service_role";

revoke trigger on table "public"."character_outfits" from "service_role";

revoke truncate on table "public"."character_outfits" from "service_role";

revoke update on table "public"."character_outfits" from "service_role";

revoke delete on table "public"."character_relationships" from "anon";

revoke insert on table "public"."character_relationships" from "anon";

revoke references on table "public"."character_relationships" from "anon";

revoke select on table "public"."character_relationships" from "anon";

revoke trigger on table "public"."character_relationships" from "anon";

revoke truncate on table "public"."character_relationships" from "anon";

revoke update on table "public"."character_relationships" from "anon";

revoke delete on table "public"."character_relationships" from "authenticated";

revoke insert on table "public"."character_relationships" from "authenticated";

revoke references on table "public"."character_relationships" from "authenticated";

revoke select on table "public"."character_relationships" from "authenticated";

revoke trigger on table "public"."character_relationships" from "authenticated";

revoke truncate on table "public"."character_relationships" from "authenticated";

revoke update on table "public"."character_relationships" from "authenticated";

revoke delete on table "public"."character_relationships" from "service_role";

revoke insert on table "public"."character_relationships" from "service_role";

revoke references on table "public"."character_relationships" from "service_role";

revoke select on table "public"."character_relationships" from "service_role";

revoke trigger on table "public"."character_relationships" from "service_role";

revoke truncate on table "public"."character_relationships" from "service_role";

revoke update on table "public"."character_relationships" from "service_role";

revoke delete on table "public"."character_worlds" from "anon";

revoke insert on table "public"."character_worlds" from "anon";

revoke references on table "public"."character_worlds" from "anon";

revoke select on table "public"."character_worlds" from "anon";

revoke trigger on table "public"."character_worlds" from "anon";

revoke truncate on table "public"."character_worlds" from "anon";

revoke update on table "public"."character_worlds" from "anon";

revoke delete on table "public"."character_worlds" from "authenticated";

revoke insert on table "public"."character_worlds" from "authenticated";

revoke references on table "public"."character_worlds" from "authenticated";

revoke select on table "public"."character_worlds" from "authenticated";

revoke trigger on table "public"."character_worlds" from "authenticated";

revoke truncate on table "public"."character_worlds" from "authenticated";

revoke update on table "public"."character_worlds" from "authenticated";

revoke delete on table "public"."character_worlds" from "service_role";

revoke insert on table "public"."character_worlds" from "service_role";

revoke references on table "public"."character_worlds" from "service_role";

revoke select on table "public"."character_worlds" from "service_role";

revoke trigger on table "public"."character_worlds" from "service_role";

revoke truncate on table "public"."character_worlds" from "service_role";

revoke update on table "public"."character_worlds" from "service_role";

revoke delete on table "public"."characters" from "anon";

revoke insert on table "public"."characters" from "anon";

revoke references on table "public"."characters" from "anon";

revoke select on table "public"."characters" from "anon";

revoke trigger on table "public"."characters" from "anon";

revoke truncate on table "public"."characters" from "anon";

revoke update on table "public"."characters" from "anon";

revoke delete on table "public"."characters" from "authenticated";

revoke insert on table "public"."characters" from "authenticated";

revoke references on table "public"."characters" from "authenticated";

revoke select on table "public"."characters" from "authenticated";

revoke trigger on table "public"."characters" from "authenticated";

revoke truncate on table "public"."characters" from "authenticated";

revoke update on table "public"."characters" from "authenticated";

revoke delete on table "public"."characters" from "service_role";

revoke insert on table "public"."characters" from "service_role";

revoke references on table "public"."characters" from "service_role";

revoke select on table "public"."characters" from "service_role";

revoke trigger on table "public"."characters" from "service_role";

revoke truncate on table "public"."characters" from "service_role";

revoke update on table "public"."characters" from "service_role";

revoke delete on table "public"."entity_tags" from "anon";

revoke insert on table "public"."entity_tags" from "anon";

revoke references on table "public"."entity_tags" from "anon";

revoke select on table "public"."entity_tags" from "anon";

revoke trigger on table "public"."entity_tags" from "anon";

revoke truncate on table "public"."entity_tags" from "anon";

revoke update on table "public"."entity_tags" from "anon";

revoke delete on table "public"."entity_tags" from "authenticated";

revoke insert on table "public"."entity_tags" from "authenticated";

revoke references on table "public"."entity_tags" from "authenticated";

revoke select on table "public"."entity_tags" from "authenticated";

revoke trigger on table "public"."entity_tags" from "authenticated";

revoke truncate on table "public"."entity_tags" from "authenticated";

revoke update on table "public"."entity_tags" from "authenticated";

revoke delete on table "public"."entity_tags" from "service_role";

revoke insert on table "public"."entity_tags" from "service_role";

revoke references on table "public"."entity_tags" from "service_role";

revoke select on table "public"."entity_tags" from "service_role";

revoke trigger on table "public"."entity_tags" from "service_role";

revoke truncate on table "public"."entity_tags" from "service_role";

revoke update on table "public"."entity_tags" from "service_role";

revoke delete on table "public"."event_factions" from "anon";

revoke insert on table "public"."event_factions" from "anon";

revoke references on table "public"."event_factions" from "anon";

revoke select on table "public"."event_factions" from "anon";

revoke trigger on table "public"."event_factions" from "anon";

revoke truncate on table "public"."event_factions" from "anon";

revoke update on table "public"."event_factions" from "anon";

revoke delete on table "public"."event_factions" from "authenticated";

revoke insert on table "public"."event_factions" from "authenticated";

revoke references on table "public"."event_factions" from "authenticated";

revoke select on table "public"."event_factions" from "authenticated";

revoke trigger on table "public"."event_factions" from "authenticated";

revoke truncate on table "public"."event_factions" from "authenticated";

revoke update on table "public"."event_factions" from "authenticated";

revoke delete on table "public"."event_factions" from "service_role";

revoke insert on table "public"."event_factions" from "service_role";

revoke references on table "public"."event_factions" from "service_role";

revoke select on table "public"."event_factions" from "service_role";

revoke trigger on table "public"."event_factions" from "service_role";

revoke truncate on table "public"."event_factions" from "service_role";

revoke update on table "public"."event_factions" from "service_role";

revoke delete on table "public"."event_participants" from "anon";

revoke insert on table "public"."event_participants" from "anon";

revoke references on table "public"."event_participants" from "anon";

revoke select on table "public"."event_participants" from "anon";

revoke trigger on table "public"."event_participants" from "anon";

revoke truncate on table "public"."event_participants" from "anon";

revoke update on table "public"."event_participants" from "anon";

revoke delete on table "public"."event_participants" from "authenticated";

revoke insert on table "public"."event_participants" from "authenticated";

revoke references on table "public"."event_participants" from "authenticated";

revoke select on table "public"."event_participants" from "authenticated";

revoke trigger on table "public"."event_participants" from "authenticated";

revoke truncate on table "public"."event_participants" from "authenticated";

revoke update on table "public"."event_participants" from "authenticated";

revoke delete on table "public"."event_participants" from "service_role";

revoke insert on table "public"."event_participants" from "service_role";

revoke references on table "public"."event_participants" from "service_role";

revoke select on table "public"."event_participants" from "service_role";

revoke trigger on table "public"."event_participants" from "service_role";

revoke truncate on table "public"."event_participants" from "service_role";

revoke update on table "public"."event_participants" from "service_role";

revoke delete on table "public"."event_types" from "anon";

revoke insert on table "public"."event_types" from "anon";

revoke references on table "public"."event_types" from "anon";

revoke select on table "public"."event_types" from "anon";

revoke trigger on table "public"."event_types" from "anon";

revoke truncate on table "public"."event_types" from "anon";

revoke update on table "public"."event_types" from "anon";

revoke delete on table "public"."event_types" from "authenticated";

revoke insert on table "public"."event_types" from "authenticated";

revoke references on table "public"."event_types" from "authenticated";

revoke select on table "public"."event_types" from "authenticated";

revoke trigger on table "public"."event_types" from "authenticated";

revoke truncate on table "public"."event_types" from "authenticated";

revoke update on table "public"."event_types" from "authenticated";

revoke delete on table "public"."event_types" from "service_role";

revoke insert on table "public"."event_types" from "service_role";

revoke references on table "public"."event_types" from "service_role";

revoke select on table "public"."event_types" from "service_role";

revoke trigger on table "public"."event_types" from "service_role";

revoke truncate on table "public"."event_types" from "service_role";

revoke update on table "public"."event_types" from "service_role";

revoke delete on table "public"."events" from "anon";

revoke insert on table "public"."events" from "anon";

revoke references on table "public"."events" from "anon";

revoke select on table "public"."events" from "anon";

revoke trigger on table "public"."events" from "anon";

revoke truncate on table "public"."events" from "anon";

revoke update on table "public"."events" from "anon";

revoke delete on table "public"."events" from "authenticated";

revoke insert on table "public"."events" from "authenticated";

revoke references on table "public"."events" from "authenticated";

revoke select on table "public"."events" from "authenticated";

revoke trigger on table "public"."events" from "authenticated";

revoke truncate on table "public"."events" from "authenticated";

revoke update on table "public"."events" from "authenticated";

revoke delete on table "public"."events" from "service_role";

revoke insert on table "public"."events" from "service_role";

revoke references on table "public"."events" from "service_role";

revoke select on table "public"."events" from "service_role";

revoke trigger on table "public"."events" from "service_role";

revoke truncate on table "public"."events" from "service_role";

revoke update on table "public"."events" from "service_role";

revoke delete on table "public"."factions" from "anon";

revoke insert on table "public"."factions" from "anon";

revoke references on table "public"."factions" from "anon";

revoke select on table "public"."factions" from "anon";

revoke trigger on table "public"."factions" from "anon";

revoke truncate on table "public"."factions" from "anon";

revoke update on table "public"."factions" from "anon";

revoke delete on table "public"."factions" from "authenticated";

revoke insert on table "public"."factions" from "authenticated";

revoke references on table "public"."factions" from "authenticated";

revoke select on table "public"."factions" from "authenticated";

revoke trigger on table "public"."factions" from "authenticated";

revoke truncate on table "public"."factions" from "authenticated";

revoke update on table "public"."factions" from "authenticated";

revoke delete on table "public"."factions" from "service_role";

revoke insert on table "public"."factions" from "service_role";

revoke references on table "public"."factions" from "service_role";

revoke select on table "public"."factions" from "service_role";

revoke trigger on table "public"."factions" from "service_role";

revoke truncate on table "public"."factions" from "service_role";

revoke update on table "public"."factions" from "service_role";

revoke delete on table "public"."locations" from "anon";

revoke insert on table "public"."locations" from "anon";

revoke references on table "public"."locations" from "anon";

revoke select on table "public"."locations" from "anon";

revoke trigger on table "public"."locations" from "anon";

revoke truncate on table "public"."locations" from "anon";

revoke update on table "public"."locations" from "anon";

revoke delete on table "public"."locations" from "authenticated";

revoke insert on table "public"."locations" from "authenticated";

revoke references on table "public"."locations" from "authenticated";

revoke select on table "public"."locations" from "authenticated";

revoke trigger on table "public"."locations" from "authenticated";

revoke truncate on table "public"."locations" from "authenticated";

revoke update on table "public"."locations" from "authenticated";

revoke delete on table "public"."locations" from "service_role";

revoke insert on table "public"."locations" from "service_role";

revoke references on table "public"."locations" from "service_role";

revoke select on table "public"."locations" from "service_role";

revoke trigger on table "public"."locations" from "service_role";

revoke truncate on table "public"."locations" from "service_role";

revoke update on table "public"."locations" from "service_role";

revoke delete on table "public"."media_assets" from "anon";

revoke insert on table "public"."media_assets" from "anon";

revoke references on table "public"."media_assets" from "anon";

revoke select on table "public"."media_assets" from "anon";

revoke trigger on table "public"."media_assets" from "anon";

revoke truncate on table "public"."media_assets" from "anon";

revoke update on table "public"."media_assets" from "anon";

revoke delete on table "public"."media_assets" from "authenticated";

revoke insert on table "public"."media_assets" from "authenticated";

revoke references on table "public"."media_assets" from "authenticated";

revoke select on table "public"."media_assets" from "authenticated";

revoke trigger on table "public"."media_assets" from "authenticated";

revoke truncate on table "public"."media_assets" from "authenticated";

revoke update on table "public"."media_assets" from "authenticated";

revoke delete on table "public"."media_assets" from "service_role";

revoke insert on table "public"."media_assets" from "service_role";

revoke references on table "public"."media_assets" from "service_role";

revoke select on table "public"."media_assets" from "service_role";

revoke trigger on table "public"."media_assets" from "service_role";

revoke truncate on table "public"."media_assets" from "service_role";

revoke update on table "public"."media_assets" from "service_role";

revoke delete on table "public"."moodboards" from "anon";

revoke insert on table "public"."moodboards" from "anon";

revoke references on table "public"."moodboards" from "anon";

revoke select on table "public"."moodboards" from "anon";

revoke trigger on table "public"."moodboards" from "anon";

revoke truncate on table "public"."moodboards" from "anon";

revoke update on table "public"."moodboards" from "anon";

revoke delete on table "public"."moodboards" from "authenticated";

revoke insert on table "public"."moodboards" from "authenticated";

revoke references on table "public"."moodboards" from "authenticated";

revoke select on table "public"."moodboards" from "authenticated";

revoke trigger on table "public"."moodboards" from "authenticated";

revoke truncate on table "public"."moodboards" from "authenticated";

revoke update on table "public"."moodboards" from "authenticated";

revoke delete on table "public"."moodboards" from "service_role";

revoke insert on table "public"."moodboards" from "service_role";

revoke references on table "public"."moodboards" from "service_role";

revoke select on table "public"."moodboards" from "service_role";

revoke trigger on table "public"."moodboards" from "service_role";

revoke truncate on table "public"."moodboards" from "service_role";

revoke update on table "public"."moodboards" from "service_role";

revoke delete on table "public"."outfit_types" from "anon";

revoke insert on table "public"."outfit_types" from "anon";

revoke references on table "public"."outfit_types" from "anon";

revoke select on table "public"."outfit_types" from "anon";

revoke trigger on table "public"."outfit_types" from "anon";

revoke truncate on table "public"."outfit_types" from "anon";

revoke update on table "public"."outfit_types" from "anon";

revoke delete on table "public"."outfit_types" from "authenticated";

revoke insert on table "public"."outfit_types" from "authenticated";

revoke references on table "public"."outfit_types" from "authenticated";

revoke select on table "public"."outfit_types" from "authenticated";

revoke trigger on table "public"."outfit_types" from "authenticated";

revoke truncate on table "public"."outfit_types" from "authenticated";

revoke update on table "public"."outfit_types" from "authenticated";

revoke delete on table "public"."outfit_types" from "service_role";

revoke insert on table "public"."outfit_types" from "service_role";

revoke references on table "public"."outfit_types" from "service_role";

revoke select on table "public"."outfit_types" from "service_role";

revoke trigger on table "public"."outfit_types" from "service_role";

revoke truncate on table "public"."outfit_types" from "service_role";

revoke update on table "public"."outfit_types" from "service_role";

revoke delete on table "public"."relationship_types" from "anon";

revoke insert on table "public"."relationship_types" from "anon";

revoke references on table "public"."relationship_types" from "anon";

revoke select on table "public"."relationship_types" from "anon";

revoke trigger on table "public"."relationship_types" from "anon";

revoke truncate on table "public"."relationship_types" from "anon";

revoke update on table "public"."relationship_types" from "anon";

revoke delete on table "public"."relationship_types" from "authenticated";

revoke insert on table "public"."relationship_types" from "authenticated";

revoke references on table "public"."relationship_types" from "authenticated";

revoke select on table "public"."relationship_types" from "authenticated";

revoke trigger on table "public"."relationship_types" from "authenticated";

revoke truncate on table "public"."relationship_types" from "authenticated";

revoke update on table "public"."relationship_types" from "authenticated";

revoke delete on table "public"."relationship_types" from "service_role";

revoke insert on table "public"."relationship_types" from "service_role";

revoke references on table "public"."relationship_types" from "service_role";

revoke select on table "public"."relationship_types" from "service_role";

revoke trigger on table "public"."relationship_types" from "service_role";

revoke truncate on table "public"."relationship_types" from "service_role";

revoke update on table "public"."relationship_types" from "service_role";

revoke delete on table "public"."resource_urls" from "anon";

revoke insert on table "public"."resource_urls" from "anon";

revoke references on table "public"."resource_urls" from "anon";

revoke select on table "public"."resource_urls" from "anon";

revoke trigger on table "public"."resource_urls" from "anon";

revoke truncate on table "public"."resource_urls" from "anon";

revoke update on table "public"."resource_urls" from "anon";

revoke delete on table "public"."resource_urls" from "authenticated";

revoke insert on table "public"."resource_urls" from "authenticated";

revoke references on table "public"."resource_urls" from "authenticated";

revoke select on table "public"."resource_urls" from "authenticated";

revoke trigger on table "public"."resource_urls" from "authenticated";

revoke truncate on table "public"."resource_urls" from "authenticated";

revoke update on table "public"."resource_urls" from "authenticated";

revoke delete on table "public"."resource_urls" from "service_role";

revoke insert on table "public"."resource_urls" from "service_role";

revoke references on table "public"."resource_urls" from "service_role";

revoke select on table "public"."resource_urls" from "service_role";

revoke trigger on table "public"."resource_urls" from "service_role";

revoke truncate on table "public"."resource_urls" from "service_role";

revoke update on table "public"."resource_urls" from "service_role";

revoke delete on table "public"."stories" from "anon";

revoke insert on table "public"."stories" from "anon";

revoke references on table "public"."stories" from "anon";

revoke select on table "public"."stories" from "anon";

revoke trigger on table "public"."stories" from "anon";

revoke truncate on table "public"."stories" from "anon";

revoke update on table "public"."stories" from "anon";

revoke delete on table "public"."stories" from "authenticated";

revoke insert on table "public"."stories" from "authenticated";

revoke references on table "public"."stories" from "authenticated";

revoke select on table "public"."stories" from "authenticated";

revoke trigger on table "public"."stories" from "authenticated";

revoke truncate on table "public"."stories" from "authenticated";

revoke update on table "public"."stories" from "authenticated";

revoke delete on table "public"."stories" from "service_role";

revoke insert on table "public"."stories" from "service_role";

revoke references on table "public"."stories" from "service_role";

revoke select on table "public"."stories" from "service_role";

revoke trigger on table "public"."stories" from "service_role";

revoke truncate on table "public"."stories" from "service_role";

revoke update on table "public"."stories" from "service_role";

revoke delete on table "public"."tags" from "anon";

revoke insert on table "public"."tags" from "anon";

revoke references on table "public"."tags" from "anon";

revoke select on table "public"."tags" from "anon";

revoke trigger on table "public"."tags" from "anon";

revoke truncate on table "public"."tags" from "anon";

revoke update on table "public"."tags" from "anon";

revoke delete on table "public"."tags" from "authenticated";

revoke insert on table "public"."tags" from "authenticated";

revoke references on table "public"."tags" from "authenticated";

revoke select on table "public"."tags" from "authenticated";

revoke trigger on table "public"."tags" from "authenticated";

revoke truncate on table "public"."tags" from "authenticated";

revoke update on table "public"."tags" from "authenticated";

revoke delete on table "public"."tags" from "service_role";

revoke insert on table "public"."tags" from "service_role";

revoke references on table "public"."tags" from "service_role";

revoke select on table "public"."tags" from "service_role";

revoke trigger on table "public"."tags" from "service_role";

revoke truncate on table "public"."tags" from "service_role";

revoke update on table "public"."tags" from "service_role";

revoke delete on table "public"."timelines" from "anon";

revoke insert on table "public"."timelines" from "anon";

revoke references on table "public"."timelines" from "anon";

revoke select on table "public"."timelines" from "anon";

revoke trigger on table "public"."timelines" from "anon";

revoke truncate on table "public"."timelines" from "anon";

revoke update on table "public"."timelines" from "anon";

revoke delete on table "public"."timelines" from "authenticated";

revoke insert on table "public"."timelines" from "authenticated";

revoke references on table "public"."timelines" from "authenticated";

revoke select on table "public"."timelines" from "authenticated";

revoke trigger on table "public"."timelines" from "authenticated";

revoke truncate on table "public"."timelines" from "authenticated";

revoke update on table "public"."timelines" from "authenticated";

revoke delete on table "public"."timelines" from "service_role";

revoke insert on table "public"."timelines" from "service_role";

revoke references on table "public"."timelines" from "service_role";

revoke select on table "public"."timelines" from "service_role";

revoke trigger on table "public"."timelines" from "service_role";

revoke truncate on table "public"."timelines" from "service_role";

revoke update on table "public"."timelines" from "service_role";

revoke delete on table "public"."worlds" from "anon";

revoke insert on table "public"."worlds" from "anon";

revoke references on table "public"."worlds" from "anon";

revoke select on table "public"."worlds" from "anon";

revoke trigger on table "public"."worlds" from "anon";

revoke truncate on table "public"."worlds" from "anon";

revoke update on table "public"."worlds" from "anon";

revoke delete on table "public"."worlds" from "authenticated";

revoke insert on table "public"."worlds" from "authenticated";

revoke references on table "public"."worlds" from "authenticated";

revoke select on table "public"."worlds" from "authenticated";

revoke trigger on table "public"."worlds" from "authenticated";

revoke truncate on table "public"."worlds" from "authenticated";

revoke update on table "public"."worlds" from "authenticated";

revoke delete on table "public"."worlds" from "service_role";

revoke insert on table "public"."worlds" from "service_role";

revoke references on table "public"."worlds" from "service_role";

revoke select on table "public"."worlds" from "service_role";

revoke trigger on table "public"."worlds" from "service_role";

revoke truncate on table "public"."worlds" from "service_role";

revoke update on table "public"."worlds" from "service_role";

alter table "public"."blog_posts" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_factions" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_gallery" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_locations" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_outfits" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_relationships" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_worlds" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."characters" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."entity_tags" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."event_factions" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."event_participants" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."event_types" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."events" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."factions" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."locations" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."media_assets" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."moodboards" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."outfit_types" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."relationship_types" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."stories" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."tags" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."timelines" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."worlds" alter column "id" set default extensions.uuid_generate_v4();

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.get_character_relationships(character_uuid uuid)
 RETURNS TABLE(related_character_id uuid, related_character_name text, relationship_type_id uuid, relationship_type_name text, relationship_description text, is_mutual boolean)
 LANGUAGE plpgsql
AS $function$
BEGIN
  RETURN QUERY
  SELECT
    c.id AS related_character_id,
    c.name AS related_character_name,
    cr.relationship_type_id,
    rt.name AS relationship_type_name,
    cr.description AS relationship_description,
    cr.is_mutual
  FROM character_relationships cr
  JOIN characters c ON cr.character_b_id = c.id
  LEFT JOIN relationship_types rt ON cr.relationship_type_id = rt.id
  WHERE cr.character_a_id = character_uuid
    AND c.deleted_at IS NULL

  UNION ALL

  -- If relationships are mutual, also include reverse relationships
  SELECT
    c.id AS related_character_id,
    c.name AS related_character_name,
    cr.relationship_type_id,
    rt.name AS relationship_type_name,
    cr.description AS relationship_description,
    cr.is_mutual
  FROM character_relationships cr
  JOIN characters c ON cr.character_a_id = c.id
  LEFT JOIN relationship_types rt ON cr.relationship_type_id = rt.id
  WHERE cr.character_b_id = character_uuid
    AND cr.is_mutual = true
    AND c.deleted_at IS NULL;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.search_entities(search_query text)
 RETURNS TABLE(entity_type text, entity_id uuid, entity_name text, entity_description text, rank real)
 LANGUAGE plpgsql
AS $function$
BEGIN
  RETURN QUERY

  -- Search stories
  SELECT
    'story'::TEXT AS entity_type,
    s.id AS entity_id,
    s.title AS entity_name,
    s.description AS entity_description,
    ts_rank(to_tsvector('english', s.title || ' ' || COALESCE(s.description, '')), plainto_tsquery('english', search_query)) AS rank
  FROM stories s
  WHERE s.deleted_at IS NULL
    AND (s.visibility = 'public' AND s.is_published = true)
    AND to_tsvector('english', s.title || ' ' || COALESCE(s.description, '')) @@ plainto_tsquery('english', search_query)

  UNION ALL

  -- Search characters
  SELECT
    'character'::TEXT,
    c.id,
    c.name,
    c.backstory,
    ts_rank(to_tsvector('english', c.name || ' ' || COALESCE(c.backstory, '')), plainto_tsquery('english', search_query))
  FROM characters c
  WHERE c.deleted_at IS NULL
    AND to_tsvector('english', c.name || ' ' || COALESCE(c.backstory, '')) @@ plainto_tsquery('english', search_query)

  UNION ALL

  -- Search factions
  SELECT
    'faction'::TEXT,
    f.id,
    f.name,
    f.description,
    ts_rank(to_tsvector('english', f.name || ' ' || COALESCE(f.description, '')), plainto_tsquery('english', search_query))
  FROM factions f
  WHERE f.deleted_at IS NULL
    AND to_tsvector('english', f.name || ' ' || COALESCE(f.description, '')) @@ plainto_tsquery('english', search_query)

  UNION ALL

  -- Search locations
  SELECT
    'location'::TEXT,
    l.id,
    l.name,
    l.description,
    ts_rank(to_tsvector('english', l.name || ' ' || COALESCE(l.description, '')), plainto_tsquery('english', search_query))
  FROM locations l
  WHERE l.deleted_at IS NULL
    AND to_tsvector('english', l.name || ' ' || COALESCE(l.description, '')) @@ plainto_tsquery('english', search_query)

  ORDER BY rank DESC
  LIMIT 50;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.trigger_set_timestamp()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_character_worlds(p_character_id uuid, p_world_ids uuid[])
 RETURNS TABLE(success boolean, message text, updated_count integer)
 LANGUAGE plpgsql
AS $function$
declare
  v_deleted_count int;
  v_inserted_count int;
  v_error_message text;
  v_world_ids uuid[];
begin
  begin
    -- Delete existing character world associations
    delete from public.character_worlds where character_id = p_character_id;
    GET DIAGNOSTICS v_deleted_count = ROW_COUNT;

    v_inserted_count := 0;

    -- Normalize inputs: remove nulls and duplicates
    v_world_ids := (select coalesce(array_agg(DISTINCT x), '{}') from unnest(coalesce(p_world_ids,'{}'::uuid[])) as t(x));

    -- Insert new associations if any worlds are provided
    if array_length(v_world_ids, 1) > 0 then
      insert into public.character_worlds (character_id, world_id)
      select p_character_id, unnest(v_world_ids);
      GET DIAGNOSTICS v_inserted_count = ROW_COUNT;
    end if;

    -- Return success with operation details
    return query select true,
      format('Updated character worlds: removed %s, added %s.', v_deleted_count, v_inserted_count),
      v_inserted_count;
  exception when others then
    v_error_message := SQLERRM;
    return query select false, v_error_message, 0;
  end;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.update_resource_urls_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
;



